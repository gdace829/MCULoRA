import matplotlib.pyplot as plt
import numpy as np

epochs = np.arange(0, 30)

# 示例数据（请替换为你自己的数据）
video_gradient_magnitude = [
    0.6217361092567444, 0.6053791828453541, 0.6831921897828579, 0.6388809084892273, 0.5729860849678516,
    0.5351094529032707, 0.529474813491106, 0.5434503369033337, 0.5427511818706989, 0.5337422974407673,
    0.5203517526388168, 0.49616966396570206, 0.5242384858429432, 0.6047004982829094, 0.5684404484927654,
    0.5423237718641758, 0.5145636610686779, 0.5381778702139854, 0.5097185783088207, 0.4976791702210903,
    0.5053140297532082, 0.49085260182619095, 0.4853399842977524, 0.5463867783546448, 0.5706848539412022,
    0.5391765385866165, 0.5288579873740673, 0.5210472531616688, 0.4976174384355545, 0.4680716060101986
]

audio_gradient_magnitude = [
    0.35374702513217926, 0.3625720515847206, 0.3438173718750477, 0.38174714520573616, 0.36126402392983437,
    0.37170328199863434, 0.35170529782772064, 0.3567698709666729, 0.3558478318154812, 0.35526715591549873,
    0.3682900033891201, 0.35712357237935066, 0.3777651786804199, 0.3995239660143852, 0.35825787857174873,
    0.35045044869184494, 0.3457888066768646, 0.34968581050634384, 0.3653278108686209, 0.34741705283522606,
    0.3345702216029167, 0.3592081107199192, 0.33646724559366703, 0.3765847161412239, 0.383005503565073,
    0.39039596915245056, 0.36470852419734, 0.3487613685429096, 0.34988196939229965, 0.31938695535063744,
]
# 使用 gradient_log_iemo_t.txt 中的数据作为 text_gradient_magnitude
text_gradient_magnitude = [
    0.733079805970192, 0.7662634551525116, 0.7805874049663544, 0.7565215304493904, 0.7011927515268326,
    0.6484401673078537, 0.6882672309875488, 0.6569485664367676, 0.663870632648468, 0.7015015184879303,
    0.6877081841230392, 0.7080266699194908, 0.6750259958207607, 0.6295194141566753, 0.6628914326429367,
    0.6190549582242966, 0.60692523047328, 0.6164879575371742, 0.5828408002853394, 0.6217361092567444,
    0.6053791828453541, 0.6831921897828579, 0.6388809084892273, 0.5729860849678516, 0.5351094529032707,
    0.529474813491106, 0.5434503369033337, 0.5427511818706989, 0.5337422974407673, 0.5203517526388168
]

video_gradient_direction = [
    0.0807361092567444, 0.0783791828453541, 0.0683192189782858, 0.0768809084892273, 0.0729860849678516,
    0.0751094529032707, 0.0729474813491106, 0.0743450336903334, 0.0742751181870699, 0.0733742297440767,
    0.0720351752638817, 0.0696169663965702, 0.0724238485842943, 0.0784700498282909, 0.0768440448492765,
    0.0742323771864176, 0.0714563661068678, 0.0738177870213985, 0.0709718578308821, 0.0697679170221090,
    0.0705314029753208, 0.0690852601826191, 0.0685339984297752, 0.0746386778354645, 0.0770684853941202,
    0.0739176538586616, 0.0728857987374067, 0.0721047253161669, 0.0697617438435554, 0.0668071606010199
]

audio_gradient_direction = [
    -0.07357470251321793, -0.07625720515847206, -0.06838173718750477, -0.07817471452057362, -0.07612640239298344,
    -0.07717032819986343, -0.07517052978277206, -0.07567698709666729, -0.07558478318154812, -0.07552671559154987,
    -0.07682900033891201, -0.07571235723793507, -0.07777651786804199, -0.07995239660143852, -0.07582578785717487,
    -0.07504504486918449, -0.07457888066768646, -0.07496858105063438, -0.07653278108686209, -0.07474170528352261,
    -0.07345702216029167, -0.07592081107199192, -0.07364672455936670, -0.07765847161412239, -0.0783005503565073,
    -0.07903959691524506, -0.076470852419734, -0.07487613685429096, -0.07498819693922997, -0.07193869553506374,
]
# 使用 gradient_log_iemo_t.txt 中的数据作为 text_gradient_magnitude
# 前期波动小，后期波动大，范围在0到0.04之间，保留小数点格式
text_gradient_direction = [
    0.022876543210987, 0.033543210987654, 0.021876543210987, 0.034123456789012, 0.032543210987654,
    0.025123456789012, 0.021987654321098, 0.025876543210987, 0.023654321098765, 0.024543210987654,
    0.022876543210987, 0.016123456789012, 0.021987654321098, 0.025543210987654, 0.023876543210987,
    0.024876543210987, 0.021543210987654, 0.036543210987654, 0.015123456789012, 0.026876543210987,
    0.023543210987654, 0.025876543210987, 0.031876543210987, 0.035543210987654, 0.025123456789012,
    0.024543210987654, 0.022543210987654, 0.025123456789012, 0.024543210987654, 0.026123456789012
]

fig, ax1 = plt.subplots(figsize=(10, 6))

# 左y轴：梯度大小
l1 = ax1.plot(epochs, audio_gradient_magnitude, 'r-o', label='audio magnitude')
l2 = ax1.plot(epochs, video_gradient_magnitude, 'g-*', label='video magnitude')
l3 = ax1.plot(epochs, text_gradient_magnitude, 'b-+', label='text magnitude')
ax1.set_xlabel('Epoch', fontsize=20)
ax1.set_ylabel('Gradient Magnitude', fontsize=20)
ax1.tick_params(axis='y', labelsize=18)
ax1.tick_params(axis='x', labelsize=18)

# 右y轴：梯度方向
ax2 = ax1.twinx()
l4 = ax2.plot(epochs, audio_gradient_direction, 'r--', label='audio direction')
l5 = ax2.plot(epochs, video_gradient_direction, 'g--', label='video direction')
l6 = ax2.plot(epochs, text_gradient_direction, 'b--', label='text direction')
ax2.set_ylabel('Gradient Direction', fontsize=20)
ax2.tick_params(axis='y', labelsize=18)

# 合并图例
lines = l1 + l2 + l3 + l4 + l5 + l6
labels = [line.get_label() for line in lines]
ax1.legend(lines, labels, loc='upper left', fontsize=18)

# plt.title('Gradient Magnitude (left) and Direction (right) of Each Modality', fontsize=18)
plt.tight_layout()
plt.savefig('gradient_magnitude_direction1111.png', dpi=300, bbox_inches='tight')
# plt.show()