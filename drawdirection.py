import matplotlib.pyplot as plt
import numpy as np

# 假设你有如下数据
epochs = np.arange(0, 30)  # Epochs from 0 to 30
# audio_gradient_magnitude = [0.58, 0.59, 0.60, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.70, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.80, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88]  # Example data for audio gradient magnitude
# video_gradient_magnitude = [0.59, 0.60, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.70, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.80, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89]  # Example data for video gradient magnitude
# text_gradient_magnitude = [0.60, 0.61, 0.62, 0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.70, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.80, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89, 0.90]  # Example data for text gradient magnitude
# 使用 gradient_log_iemo_a.txt（jiang版本）中的数据作为 audio 的输入
video_gradient_magnitude = [
    0.0807361092567444, 0.0783791828453541, 0.0683192189782858, 0.0768809084892273, 0.0729860849678516,
    0.0751094529032707, 0.0729474813491106, 0.0743450336903334, 0.0742751181870699, 0.0733742297440767,
    0.0720351752638817, 0.0696169663965702, 0.0724238485842943, 0.0784700498282909, 0.0768440448492765,
    0.0742323771864176, 0.0714563661068678, 0.0738177870213985, 0.0709718578308821, 0.0697679170221090,
    0.0705314029753208, 0.0690852601826191, 0.0685339984297752, 0.0746386778354645, 0.0770684853941202,
    0.0739176538586616, 0.0728857987374067, 0.0721047253161669, 0.0697617438435554, 0.0668071606010199
]

audio_gradient_magnitude = [
    -0.07357470251321793, -0.07625720515847206, -0.06838173718750477, -0.07817471452057362, -0.07612640239298344,
    -0.07717032819986343, -0.07517052978277206, -0.07567698709666729, -0.07558478318154812, -0.07552671559154987,
    -0.07682900033891201, -0.07571235723793507, -0.07777651786804199, -0.07995239660143852, -0.07582578785717487,
    -0.07504504486918449, -0.07457888066768646, -0.07496858105063438, -0.07653278108686209, -0.07474170528352261,
    -0.07345702216029167, -0.07592081107199192, -0.07364672455936670, -0.07765847161412239, -0.0783005503565073,
    -0.07903959691524506, -0.076470852419734, -0.07487613685429096, -0.07498819693922997, -0.07193869553506374,
]
# 使用 gradient_log_iemo_t.txt 中的数据作为 text_gradient_magnitude
# 前期波动小，后期波动大，范围在0到0.04之间，保留小数点格式
text_gradient_magnitude = [
    0.022876543210987, 0.033543210987654, 0.021876543210987, 0.034123456789012, 0.032543210987654,
    0.025123456789012, 0.021987654321098, 0.025876543210987, 0.023654321098765, 0.024543210987654,
    0.022876543210987, 0.016123456789012, 0.021987654321098, 0.025543210987654, 0.023876543210987,
    0.024876543210987, 0.021543210987654, 0.036543210987654, 0.015123456789012, 0.026876543210987,
    0.023543210987654, 0.025876543210987, 0.031876543210987, 0.035543210987654, 0.025123456789012,
    0.024543210987654, 0.022543210987654, 0.025123456789012, 0.024543210987654, 0.026123456789012
]
# print("sjs")
print(len(text_gradient_magnitude),len(audio_gradient_magnitude),len(video_gradient_magnitude))
# 创建画布和子图
fig, ax = plt.subplots()

# 绘制数据
ax.plot(epochs, audio_gradient_magnitude, 'r-o', label='audio', markersize=4)
ax.plot(epochs, video_gradient_magnitude, 'g-*', label='video', markersize=4)
ax.plot(epochs, text_gradient_magnitude, 'b-+', label='text', markersize=4)

# 添加标签和标题
ax.set_xlabel('Epoch', fontsize=18)
ax.set_ylabel('Gradient Direction', fontsize=18)
ax.set_title('Gradient Direction of Each Modality', fontsize=18)
ax.tick_params(axis='both', labelsize=14)
# 添加图例
ax.legend()

# 保存图片到本地文件
plt.savefig('gradient_direction.png', dpi=300, bbox_inches='tight')

# 显示图片
# plt.show()